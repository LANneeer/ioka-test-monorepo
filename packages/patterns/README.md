# patterns
Библиотека **паттернов DDD / EDA** для сервисов в `ioka-two`.

## Состав
- `aggregate.py` — базовый агрегат с генерацией событий
- `message.py` — команды и события
- `message_bus.py` — шина сообщений (command + event handlers)
- `repository.py` — абстрактные репозитории
- `unit_of_work.py` — паттерн Unit of Work (sync/async)
- `observability.py` — паттерн Observability (async)

## Использование
 - aggregate - нужен для инкапсуляции бизнес-логики и инвариантов в доменной модели; использует события для фиксации изменений.

 - message - нужен для разделения команд (намерений) и событий (фактов); используется агрегатами и шиной сообщений.

 - message_bus - нужен для маршрутизации команд и событий к их обработчикам; использует Unit of Work и хендлеры.

 - repository - нужен для абстракции доступа к БД; использует ORM и маппинг доменных объектов.

 - unit_of_work - нужен для атомарности транзакций и публикации событий; использует репозитории и шину сообщений.

 - observability - нужен для сбора логов, метрик и аудита; используется в хендлерах и UoW как hook.
